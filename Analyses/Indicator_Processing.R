library(ggplot2)
library(tidyr)
library(viridis)
library(tidyverse)
library(reshape2)
library(cowplot)
library(dplyr)
library(randomcoloR)
library(ggpubr)
library(RColorBrewer)
library(extrafont)
library(webr)
library(networkD)
library(ggradar)
library(fmsb)
library(scales)
library(moonBook)
library(randomcoloR)
library(rlist)

## 1. Set the directory to the SWE raw .csvs from the extraction code 
## You will only need to do this once
dir = "D:/Projects/Project_Indicators/Data/Spreadsheets/ClusterResults/" 
setwd(dir)

## 2. Create a list of all files matching the GCM name in the SWE directory
list = list.files(path = dir, 
                  pattern=glob2rx("*csv*"), # Input GCM name here
                  recursive = TRUE)
lapply.dat = lapply(list, read.csv) # Read in the list as .csvs

names = gsub(".csv*","",list)
names = gsub("Indicators_","",names)
names = gsub("([0-9])([A-Z])","\\1 \\2",names)
names(lapply.dat) = names
map.dat = Map(cbind, lapply.dat, Code.Sub = names)
data.df = list.rbind(map.dat) # create a dataframe of all lists
dataframe = data.df
###############################################################################
## +++++++++++++++++++++++++++++ Lookup Table ++++++++++++++++++++++++++++++###
###############################################################################
## Sub-Domain conversion based on codebook
dataframe$Sub_Domain = ifelse(dataframe$Code.Sub == "A", "Water Source", 
                              ifelse(dataframe$Code.Sub == "B", "Water Quality", 
                                     ifelse(dataframe$Code.Sub == "C", "Water Infrastructure & Distribution",
                                            ifelse(dataframe$Code.Sub == "D", "Physical Environment",
                                                   ifelse(dataframe$Code.Sub == "E", "Industrial Water & Land Use",
                                                          ifelse(dataframe$Code.Sub == "F", "Urban & Municipal Water & Land Use",
                                                                 ifelse(dataframe$Code.Sub == "G", "Agricultural Land & Water Use",
                                                                        ifelse(dataframe$Code.Sub == "H", "Cultural & Environemntal Land & Water Use",
                                                                               ifelse(dataframe$Code.Sub == "I", "General Land & Water Use",
                                                                                      ifelse(dataframe$Code.Sub == "J", "Institutions & Management", 
                                                                                             ifelse(dataframe$Code.Sub == "K", "Socio-Cultural", 
                                                                                                    "Economic")))))))))))


write.csv(dataframe, "Indicators_full.csv")
